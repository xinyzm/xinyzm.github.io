<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>学海无涯『意泛舟』</title>
  
  <subtitle>时间不在于你拥有多少，而在于你如何使用</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.xinyzm.top/"/>
  <updated>2020-05-18T09:17:52.339Z</updated>
  <id>http://www.xinyzm.top/</id>
  
  <author>
    <name>信影子慕</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Jenkins 和 Gitlab 配合执行项目任务</title>
    <link href="http://www.xinyzm.top/Jenkins%E5%92%8CGitlab%E9%85%8D%E5%90%88%E6%89%A7%E8%A1%8C%E9%A1%B9%E7%9B%AE%E4%BB%BB%E5%8A%A1/"/>
    <id>http://www.xinyzm.top/Jenkins%E5%92%8CGitlab%E9%85%8D%E5%90%88%E6%89%A7%E8%A1%8C%E9%A1%B9%E7%9B%AE%E4%BB%BB%E5%8A%A1/</id>
    <published>2020-05-13T03:00:00.000Z</published>
    <updated>2020-05-18T09:17:52.339Z</updated>
    
    <content type="html"><![CDATA[<h3 id="在-Gitlab-创建-git-项目"><a href="#在-Gitlab-创建-git-项目" class="headerlink" title="在 Gitlab 创建 git 项目"></a>在 Gitlab 创建 git 项目</h3><h3 id="使用-sshkey-命令创建一对-ssh-公私钥，用于-deploy"><a href="#使用-sshkey-命令创建一对-ssh-公私钥，用于-deploy" class="headerlink" title="使用 sshkey 命令创建一对 ssh 公私钥，用于 deploy"></a>使用 sshkey 命令创建一对 ssh 公私钥，用于 deploy</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -b 4096 -C &quot;youremail@xxx.com&quot; -f &quot;sshkey_filename&quot;</span><br></pre></td></tr></table></figure><h3 id="在-Jenkins-中添加-ssh-私钥凭据"><a href="#在-Jenkins-中添加-ssh-私钥凭据" class="headerlink" title="在 Jenkins 中添加 ssh 私钥凭据"></a>在 Jenkins 中添加 ssh 私钥凭据</h3><p>（1）选择凭据 - 系统 - 全局凭据 - 添加凭据</p><p><img src="添加凭据-1.jpg" alt="添加凭据-1"></p><p>（2）选择类型 <strong>SSH Username with private key</strong>，填写用户名和 ssh 私钥，如果生成公私钥的时候设置了 passphrase 就填写，否则不填</p><p><img src="填写凭证-2.jpg" alt="填写凭证-2"></p><h3 id="在-Gitlab-中配置-Deploy-Keys（添加-ssh-公钥）"><a href="#在-Gitlab-中配置-Deploy-Keys（添加-ssh-公钥）" class="headerlink" title="在 Gitlab 中配置 Deploy Keys（添加 ssh 公钥）"></a>在 Gitlab 中配置 Deploy Keys（添加 ssh 公钥）</h3><p>（1） 此步骤的前提是你拥有这个 git 项目的管理权限</p><p>（2） 选择 git 项目 - 设置 - 仓库 - Deploy Keys ，填写 ssh 公钥，保存</p><p><img src="配置deploy keys.jpg" alt="配置deploy keys"></p><p>（3）激活新增的 deploy key </p><p><img src="激活deploy key.jpg" alt="激活deploy key"></p><h3 id="在-Jenkins-中新建任务"><a href="#在-Jenkins-中新建任务" class="headerlink" title="在 Jenkins 中新建任务"></a>在 Jenkins 中新建任务</h3><h3 id="配置任务-源码管理"><a href="#配置任务-源码管理" class="headerlink" title="配置任务 - 源码管理"></a>配置任务 - 源码管理</h3><p>（1） 选择 Git</p><p>（2） 设置仓库地址，仓库地址从 Gitlab 中获取</p><p>（3） 凭据选择你刚才使用 ssh 私钥添加的凭据</p><p>（4） 指定分支，建议设置成 master</p><p>（5） 如果需要部署的项目目录不是根目录，通过 Additional Behaviours -&gt; Sparse Checkout paths（安装 Git Parameter 插件） -&gt; Path 设置</p><p><img src="配置任务-源码管理.jpg" alt="配置任务-源码管理"></p><h3 id="配置任务-构建触发器"><a href="#配置任务-构建触发器" class="headerlink" title="配置任务 - 构建触发器"></a>配置任务 - 构建触发器</h3><p>（1）勾选 Build when a change is pushed to Gitlab.</p><p>（2）查看 Jenkins 的 webhooks 的地址，点击高级按钮，生成 Secret token</p><p><img src="获取webhooks地址.jpg" alt="获取webhooks地址"><img src="生成Secret token.jpg" alt="生成Secret token"></p><p>（3） 选择 git 项目 - 设置 - 集成 ，填写 Webhooks 的 URL 和 Secret Token，取消勾选 Enable SSL verification</p><p><img src="填写webhooks和token.jpg" alt="填写webhooks和token"></p><h3 id="配置任务-构建"><a href="#配置任务-构建" class="headerlink" title="配置任务 - 构建"></a>配置任务 - 构建</h3><p>（1） 增加构建步骤 - 执行 shell </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo 'Hello World!'</span><br></pre></td></tr></table></figure><h3 id="在-Gitlab-进行测试"><a href="#在-Gitlab-进行测试" class="headerlink" title="在 Gitlab 进行测试"></a>在 Gitlab 进行测试</h3><p>（1）选择 git 项目 - 设置 - 集成，在新创建的 Webhooks 下，点击 Test，选择 Push events</p><p>（2） 在 Jenkins 中查看新创建的任务是否正确执行并打印 <strong>Hello World!</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;在-Gitlab-创建-git-项目&quot;&gt;&lt;a href=&quot;#在-Gitlab-创建-git-项目&quot; class=&quot;headerlink&quot; title=&quot;在 Gitlab 创建 git 项目&quot;&gt;&lt;/a&gt;在 Gitlab 创建 git 项目&lt;/h3&gt;&lt;h3 id=&quot;使
      
    
    </summary>
    
    
      <category term="运维" scheme="http://www.xinyzm.top/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="Jenkins" scheme="http://www.xinyzm.top/tags/Jenkins/"/>
    
  </entry>
  
  <entry>
    <title>Centos 安装 jdk+tomcat+mysql</title>
    <link href="http://www.xinyzm.top/Centos%E5%AE%89%E8%A3%85jdk-tomcat-mysql/"/>
    <id>http://www.xinyzm.top/Centos%E5%AE%89%E8%A3%85jdk-tomcat-mysql/</id>
    <published>2020-05-12T06:00:00.000Z</published>
    <updated>2020-05-18T09:31:24.646Z</updated>
    
    <content type="html"><![CDATA[<h3 id="安装-jdk1-8"><a href="#安装-jdk1-8" class="headerlink" title="安装  jdk1.8"></a>安装  jdk1.8</h3><p>（1）前往 <a href="https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html" target="_blank" rel="noopener">Oracle 官网</a>，选择下载 <strong>xxx-linux-xxx.tar.gz</strong> 压缩包到本地（以 jdk-8u152-linux-x64.tar.gz 为例）</p><p>（2）使用 <strong><a href="https://filezilla-project.org/" target="_blank" rel="noopener">filezilla</a></strong> 将下载的 jdk 压缩包上传至 Linux 系统下（/home/java/jdk-8u152-linux-x64.tar.gz）</p><p>（3）解压 jdk 到当前目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf jdk-8u152-linux-x64.tar.gz</span><br></pre></td></tr></table></figure><p>（4）配置 jdk 的环境变量</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 将以下配置放在文件最后</span></span><br><span class="line">export JAVA_HOME=/home/java/jdk-8u152-linux-x64</span><br><span class="line">export JRE_HOME=/home/java/jdk-8u152-linux-x64/jre</span><br><span class="line">export CLASSPATH=.:$CLASSPATH:$JAVA_HOME/lib:$JRE_HOME/lib</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin</span><br></pre></td></tr></table></figure><p>（5）执行上述文件，使其生效</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><p>（6）查看 java 版本，验证是否安装成功</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure><h3 id="安装-tomcat8-5"><a href="#安装-tomcat8-5" class="headerlink" title="安装  tomcat8.5"></a>安装  tomcat8.5</h3><p>（1）前往 <a href="https://tomcat.apache.org/download-80.cgi" target="_blank" rel="noopener">Apache Tomcat</a>，选择下载 <strong>Core - tar.gz</strong> 压缩包到本地（以 apache-tomcat-8.5.24.tar.gz 为例），如下图</p><p><img src="tomcat下载.png" alt="tomcat下载"></p><p>（2）使用 <strong><a href="https://filezilla-project.org/" target="_blank" rel="noopener">filezilla</a></strong> 将下载的 tomcat 压缩包上传至 Linux 系统下（/home/tomcat/apache-tomcat-8.5.24.tar.gz）</p><p>（3）解压 tomcat 到当前目录</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf apache-tomcat-8.5.24.tar.gz</span><br></pre></td></tr></table></figure><p>（4）启动和关闭 tomcat</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动 tomcat</span></span><br><span class="line">./home/tomcat/apache-tomcat-8.5.24/bin/startup.sh</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 关闭 tomcat</span></span><br><span class="line">./home/tomcat/apache-tomcat-8.5.24/bin/shutdown.sh</span><br></pre></td></tr></table></figure><h3 id="安装-mysql5-7"><a href="#安装-mysql5-7" class="headerlink" title="安装  mysql5.7"></a>安装  mysql5.7</h3><p>（1）前往 <a href="https://downloads.mysql.com/archives/community/" target="_blank" rel="noopener">MySQL官网</a>，选择如下图所示的 mysql 版本下载到本地（以 mysql-5.7.29-linux-glibc2.12-x86_64.tar.gz 为例）</p><p><img src="mysql下载.png" alt="mysql下载"></p><p>（2）使用 <strong><a href="https://filezilla-project.org/" target="_blank" rel="noopener">filezilla</a></strong> 将下载的 mysql 压缩包上传至 Linux 系统下（/home/mysql/mysql-5.7.29-linux-glibc2.12-x86_64.tar.gz）</p><p>（3）解压 mysql 到 <strong>/usr/local/mysql</strong> 目录下</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf mysql-5.7.29-linux-glibc2.12-x86_64.tar.gz -C /usr/local/mysql/</span><br></pre></td></tr></table></figure><p>（4）添加系统组和用户</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">groupadd mysql</span><br><span class="line">useradd -r -g mysql -s /bin/false mysql</span><br></pre></td></tr></table></figure><p>（5）修改 mysql 目录拥有者为 mysql 用户</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/mysql</span><br><span class="line">chown -R mysql:mysql ./</span><br></pre></td></tr></table></figure><p>（6）数据库初始化，并且保存最后生成的密码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/mysql/bin</span><br><span class="line">./mysqld --initialize --datadir=/usr/local/mysql/data --user=mysql --basedir=/usr/local/mysql</span><br></pre></td></tr></table></figure><p>（7）修改 data 目录拥有者为 mysql 用户</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown -R mysql:mysql data</span><br></pre></td></tr></table></figure><p>（8）复制启动文件到服务文件夹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp support-files/mysql.server /etc/init.d/mysql</span><br></pre></td></tr></table></figure><p>（9）启动 mysql 服务，并设置开机自启动</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service mysql start</span><br><span class="line">systemctl enable mysql</span><br></pre></td></tr></table></figure><p>（10）添加 mysql 软连接</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/local/mysql/bin/mysql /usr/local/bin/mysql</span><br></pre></td></tr></table></figure><p>（11）登录 mysql，密码是在第六步生成的</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure><p>（12）修改 root 密码，并且开发权限使用 navicat 可以连接 mysql</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 修改root密码</span></span><br><span class="line">ALTER USER 'root'@'%' IDENTIFIED WITH mysql_native_password BY '123456';</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 赋予root用户远程连接权限</span></span><br><span class="line">GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '123456' WITH GRANT OPTION;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 刷新权限</span></span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;安装-jdk1-8&quot;&gt;&lt;a href=&quot;#安装-jdk1-8&quot; class=&quot;headerlink&quot; title=&quot;安装  jdk1.8&quot;&gt;&lt;/a&gt;安装  jdk1.8&lt;/h3&gt;&lt;p&gt;（1）前往 &lt;a href=&quot;https://www.oracle.com/ja
      
    
    </summary>
    
    
      <category term="运维" scheme="http://www.xinyzm.top/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="Linux" scheme="http://www.xinyzm.top/tags/Linux/"/>
    
  </entry>
  
</feed>
